/*
 * Copyright (c) 2019 ARM Limited.
 *
 * SPDX-License-Identifier: MIT
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
#ifdef __aarch64__

#include <algorithm>

#include "arm_gemm.hpp"


#include "../../asmlib.hpp"
#include "../../utils.hpp"

namespace arm_gemm {

void a64_smallK_hybrid_fp32_mla_4x8(const float *A, int lda, const float *B, float *C, int ldc, int M, int N, int K, const float *bias, Activation act, bool) {
    const long loops_count = iceildiv(N, (int)4) - 1;
    const long ldab = lda * sizeof(float);
    const long ldcb = ldc * sizeof(float);
    float nullbias[4];
    if (!bias) {
        memset(nullbias, 0, (4 * sizeof(float)));
    }
//    float minval = - static_cast<float>(std::numeric_limits<float>::infinity());
//    float maxval =   static_cast<float>(std::numeric_limits<float>::infinity());
//    const float * const minptr = &minval;
//    const float * const maxptr = &maxval;
    /*riscv*/
    volatile float minval = - static_cast<float>(std::numeric_limits<float>::infinity());
    volatile float maxval =   static_cast<float>(std::numeric_limits<float>::infinity());
    volatile float * minptr = &minval;
    volatile float * const maxptr = &maxval;

    switch(act.type)
    {
        default:
        case Activation::Type::None:
            break;
        case Activation::Type::BoundedReLU:
            maxval = static_cast<float>(act.param1);
            /* fall through */
        case Activation::Type::ReLU:
            minval = 0.0f;
            break;
    }

    for (int y0=0; y0<M; y0+=8) {
        long loops = loops_count;
        long oob_rows = std::max(8 - (M-y0), 0);
        const float *b_ptr0 = B;
        const float *biasptr = bias ? bias : nullbias;
        const uint64_t biasinc = bias ? 4*sizeof(float) : 0;
        const float *a_ptr0 = A + (y0 * lda);

        float *c_ptr0 = C + (y0 * ldc);

        /*riscv*/
        float s[4] = {0,0,0,0};
        float *s0 = s;
        float *s1 = s0 + 1;
        float *s2 = s1 + 1;
        float *s3 = s2 + 1;
        int g = 0;
        int h = 0;

        switch(K) {
            case 1:
                __asm__ __volatile__(
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"
			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v1, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"13:\n"

			"add %[b_ptr0], %[b_ptr0], 0x10\n"
			"beqz           %[loops], 2f\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
            "flw            f0, (%[minptr])\n"
            "vfmv.v.f          v22, f0\n"
            "flw            f0, (%[maxptr])\n"
            "vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add %[b_ptr0], %[b_ptr0], 0x10\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez           %[loops], 4b\n"
			"3:\n"
            "flw            f0, (%[minptr])\n"
            "vfmv.v.f          v22, f0\n"
            "flw            f0, (%[maxptr])\n"
            "vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add %[b_ptr0], %[b_ptr0], 0x10\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j              5f\n"
			"2:\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"5:\n"
            "flw            f0, (%[minptr])\n"
            "vfmv.v.f          v22, f0\n"
            "flw            f0, (%[maxptr])\n"
            "vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"

                    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [g] "+r" (g), [h] "+r" (h)
                    : [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
                    : "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
                        "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
                        );
                break;
            case 2:
                __asm__ __volatile__(
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"
			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v1, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"13:\n"

			"add %[b_ptr0], %[b_ptr0], 0x20\n"
			"beqz           %[loops], 2f\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x20\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez           %[loops], 4b\n"
			"3:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x20\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j              5f\n"
			"2:\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"5:\n"
            "flw            f0, (%[minptr])\n"
            "vfmv.v.f          v22, f0\n"
            "flw            f0, (%[maxptr])\n"
            "vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"

                    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [g] "+r" (g), [h] "+r" (h)
                    : [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
                    : "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
                      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
                        );
                break;
            case 3:
                __asm__ __volatile__(
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"

			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v1, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"13:\n"

			"add %[b_ptr0], %[b_ptr0], 0x30\n"
			"beqz           %[loops], 2f\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x30\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez           %[loops], 4b\n"
			"3:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x30\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j              5f\n"
			"2:\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"5:\n"
            "flw            f0, (%[minptr])\n"
            "vfmv.v.f          v22, f0\n"
            "flw            f0, (%[maxptr])\n"
            "vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"

                    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [s2] "+r" (s2), [g] "+r" (g), [h] "+r" (h)
                    : [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
                    : "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
                      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
                        );
                break;
            case 4:
                __asm__ __volatile__(
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"

			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add            a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x40\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v1, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"13:\n"

			"beqz           %[loops], 2f\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add            a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x40\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez           %[loops], 4b\n"
			"3:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add            a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add            a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x40\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j              5f\n"
			"2:\n"
			"vle32.v          v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			"5:\n"
            "flw            f0, (%[minptr])\n"
            "vfmv.v.f          v22, f0\n"
	        "flw            f0, (%[maxptr])\n"
            "vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"

                    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [s2] "+r" (s2), [s3] "+r" (s3), [g] "+r" (g), [h] "+r" (h)
                    : [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
                    : "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
                      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
                        );
                break;
            case 5:
                __asm__ __volatile__(
"li  a0, 4\n"
"vsetvli  t0, a0, e32, m1\n"

"add a3, %[c_ptr0], %[ldc]\n"
"add a5, a3, %[ldc]\n"
"add a7, a5, %[ldc]\n"
"add t2, a7, %[ldc]\n"
"add t4, t2, %[ldc]\n"
"add a2, t4, %[ldc]\n"
"add a4, a2, %[ldc]\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add a4, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b1\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add a2, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b10\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add t4, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b100\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add t2, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b1000\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add a7, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b10000\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add a5, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b100000\n"
"beqz           %[oob_rows], 1f\n"
"addi %[oob_rows], %[oob_rows], -0x1\n"
"add a3, %[c_ptr0], 0x0\n"
"add %[g], %[g], 0b1000000\n"

"1:\n"
"vle32.v          v16, (%[b_ptr0])\n"
"add            a1, %[b_ptr0], 0x10\n"
"vle32.v          v17, (a1)\n"
"add            a1, %[b_ptr0], 0x20\n"
"vle32.v          v18, (a1)\n"
"add            a1, %[b_ptr0], 0x30\n"
"vle32.v          v19, (a1)\n"
"add            a1, %[b_ptr0], 0x40\n"
"vle32.v          v20, (a1)\n"
"add %[b_ptr0], %[b_ptr0], 0x50\n"

"vle32.v          v0, (%[a_ptr0])\n"
"andi           %[h], %[g], 0b1000000\n"
"bnez           %[h],6f\n"
"add a1, %[a_ptr0], %[lda]\n"
"vle32.v          v2, (a1)\n"
"andi           %[h], %[g], 0b100000\n"
"bnez           %[h],7f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v4, (a1)\n"
"andi           %[h], %[g], 0b10000\n"
"bnez           %[h],8f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v6, (a1)\n"
"andi           %[h], %[g], 0b1000\n"
"bnez           %[h],9f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v8, (a1)\n"
"andi           %[h], %[g], 0b100\n"
"bnez           %[h],10f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v10, (a1)\n"
"andi           %[h], %[g], 0b10\n"
"bnez           %[h],11f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v12, (a1)\n"
"andi           %[h], %[g], 0b1\n"
"bnez           %[h],12f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v14, (a1)\n"
"j              13f\n"
"6:\n"
"vle32.v          v2, (%[a_ptr0])\n"
"7:\n"
"vle32.v          v4, (%[a_ptr0])\n"
"8:\n"
"vle32.v          v6, (%[a_ptr0])\n"
"9:\n"
"vle32.v          v8, (%[a_ptr0])\n"
"10:\n"
"vle32.v          v10, (%[a_ptr0])\n"
"11:\n"
"vle32.v          v12, (%[a_ptr0])\n"
"12:\n"
"vle32.v          v14, (%[a_ptr0])\n"
"13:\n"
"add %[a_ptr0], %[a_ptr0], 0x10\n"
"vle32.v          v1, (%[a_ptr0])\n"
"andi           %[h], %[g], 0b1000000\n"
"bnez           %[h],14f\n"
"add a1, %[a_ptr0], %[lda]\n"
"vle32.v          v3, (a1)\n"
"andi           %[h], %[g], 0b100000\n"
"bnez           %[h],15f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v5, (a1)\n"
"andi           %[h], %[g], 0b10000\n"
"bnez           %[h],16f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v7, (a1)\n"
"andi           %[h], %[g], 0b1000\n"
"bnez           %[h],17f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v9, (a1)\n"
"andi           %[h], %[g], 0b100\n"
"bnez           %[h],18f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v11, (a1)\n"
"andi           %[h], %[g], 0b10\n"
"bnez           %[h],19f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v13, (a1)\n"
"andi           %[h], %[g], 0b1\n"
"bnez           %[h],20f\n"
"add a1, a1, %[lda]\n"
"vle32.v          v15, (a1)\n"
"j              21f\n"
"14:\n"
"vle32.v          v3, (%[a_ptr0])\n"
"15:\n"
"vle32.v          v5, (%[a_ptr0])\n"
"16:\n"
"vle32.v          v7, (%[a_ptr0])\n"
"17:\n"
"vle32.v          v9, (%[a_ptr0])\n"
"18:\n"
"vle32.v          v11, (%[a_ptr0])\n"
"19:\n"
"vle32.v          v13, (%[a_ptr0])\n"
"20:\n"
"vle32.v          v15, (%[a_ptr0])\n"
"21:\n"

"beqz           %[loops], 2f\n"
"vle32.v          v24, (%[biasptr])\n"
"add %[biasptr], %[biasptr], %[biasinc]\n"
"addi %[loops], %[loops], -0x1\n"
"vmv.v.v v25, v24\n"
"vmv.v.v v26, v24\n"
"vmv.v.v v27, v24\n"
"vmv.v.v v28, v24\n"
"vmv.v.v v29, v24\n"
"vmv.v.v v30, v24\n"
"vmv.v.v v31, v24\n"
"vse32.v          v0, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v24, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v24, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v24, f0, v19\n"
"vse32.v          v2, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v25, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v25, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v25, f0, v19\n"
"vse32.v          v4, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v26, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v26, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v26, f0, v19\n"
"vse32.v          v6, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v27, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v27, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v27, f0, v19\n"
"vse32.v          v8, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v28, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v28, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v28, f0, v19\n"
"vse32.v          v10, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v29, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v29, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v29, f0, v19\n"
"vse32.v          v12, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v30, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v30, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v30, f0, v19\n"
"vse32.v          v14, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v31, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v31, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v31, f0, v19\n"
"vse32.v          v1, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v20\n"
"vse32.v          v3, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v20\n"
"vse32.v          v5, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v20\n"
"vse32.v          v7, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v20\n"
"vse32.v          v9, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v20\n"
"vse32.v          v11, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v20\n"
"vse32.v          v13, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v20\n"
"vse32.v          v15, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v20\n"
"beqz           %[loops], 3f\n"
"4:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
"addi %[loops], %[loops], -0x1\n"
"vle32.v          v16, (%[b_ptr0])\n"
"add            a1, %[b_ptr0], 0x10\n"
"vle32.v          v17, (a1)\n"
"add            a1, %[b_ptr0], 0x20\n"
"vle32.v          v18, (a1)\n"
"add            a1, %[b_ptr0], 0x30\n"
"vle32.v          v19, (a1)\n"
"add            a1, %[b_ptr0], 0x40\n"
"vle32.v          v20, (a1)\n"
"add %[b_ptr0], %[b_ptr0], 0x50\n"
"vfmax.vv v24, v24, v22\n"
"vfmax.vv v25, v25, v22\n"
"vfmax.vv v26, v26, v22\n"
"vfmax.vv v27, v27, v22\n"
"vfmax.vv v28, v28, v22\n"
"vfmax.vv v29, v29, v22\n"
"vfmax.vv v30, v30, v22\n"
"vfmax.vv v31, v31, v22\n"
"vfmin.vv v24, v24, v23\n"
"vfmin.vv v25, v25, v23\n"
"vfmin.vv v26, v26, v23\n"
"vfmin.vv v27, v27, v23\n"
"vfmin.vv v28, v28, v23\n"
"vfmin.vv v29, v29, v23\n"
"vfmin.vv v30, v30, v23\n"
"vfmin.vv v31, v31, v23\n"
"vse32.v          v24, (%[c_ptr0])\n"
"vle32.v          v24, (%[biasptr])\n"
"vse32.v          v25, (a3)\n"
"vse32.v          v26, (a5)\n"
"vse32.v          v27, (a7)\n"
"vse32.v          v28, (t2)\n"
"vse32.v          v29, (t4)\n"
"vse32.v          v30, (a2)\n"
"vse32.v          v31, (a4)\n"
"add %[c_ptr0], %[c_ptr0], 0x10\n"
"add a3, a3, 0x10\n"
"add a5, a5, 0x10\n"
"add a7, a7, 0x10\n"
"add t2, t2, 0x10\n"
"add t4, t4, 0x10\n"
"add a2, a2, 0x10\n"
"add a4, a4, 0x10\n"
"vmv.v.v v25, v24\n"
"vmv.v.v v26, v24\n"
"vmv.v.v v27, v24\n"
"vmv.v.v v28, v24\n"
"vmv.v.v v29, v24\n"
"vmv.v.v v30, v24\n"
"vmv.v.v v31, v24\n"
"vse32.v          v0, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v24, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v24, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v24, f0, v19\n"
"vse32.v          v2, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v25, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v25, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v25, f0, v19\n"
"vse32.v          v4, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v26, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v26, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v26, f0, v19\n"
"vse32.v          v6, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v27, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v27, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v27, f0, v19\n"
"vse32.v          v8, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v28, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v28, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v28, f0, v19\n"
"vse32.v          v10, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v29, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v29, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v29, f0, v19\n"
"vse32.v          v12, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v30, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v30, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v30, f0, v19\n"
"vse32.v          v14, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v31, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v31, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v31, f0, v19\n"
"vse32.v          v1, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v20\n"
"vse32.v          v3, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v20\n"
"vse32.v          v5, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v20\n"
"vse32.v          v7, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v20\n"
"vse32.v          v9, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v20\n"
"vse32.v          v11, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v20\n"
"vse32.v          v13, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v20\n"
"vse32.v          v15, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v20\n"
"add %[biasptr], %[biasptr], %[biasinc]\n"
"bnez           %[loops], 4b\n"
"3:\n"
                		"flw            f0, (%[minptr])\n"
                		"vfmv.v.f          v22, f0\n"
                		"flw            f0, (%[maxptr])\n"
                		"vfmv.v.f          v23, f0\n"
"vle32.v          v16, (%[b_ptr0])\n"
"add            a1, %[b_ptr0], 0x10\n"
"vle32.v          v17, (a1)\n"
"add            a1, %[b_ptr0], 0x20\n"
"vle32.v          v18, (a1)\n"
"add            a1, %[b_ptr0], 0x30\n"
"vle32.v          v19, (a1)\n"
"add            a1, %[b_ptr0], 0x40\n"
"vle32.v          v20, (a1)\n"
"add %[b_ptr0], %[b_ptr0], 0x50\n"
"vfmax.vv v24, v24, v22\n"
"vfmax.vv v25, v25, v22\n"
"vfmax.vv v26, v26, v22\n"
"vfmax.vv v27, v27, v22\n"
"vfmax.vv v28, v28, v22\n"
"vfmax.vv v29, v29, v22\n"
"vfmax.vv v30, v30, v22\n"
"vfmax.vv v31, v31, v22\n"
"vfmin.vv v24, v24, v23\n"
"vfmin.vv v25, v25, v23\n"
"vfmin.vv v26, v26, v23\n"
"vfmin.vv v27, v27, v23\n"
"vfmin.vv v28, v28, v23\n"
"vfmin.vv v29, v29, v23\n"
"vfmin.vv v30, v30, v23\n"
"vfmin.vv v31, v31, v23\n"
"vse32.v          v24, (%[c_ptr0])\n"
"vle32.v          v24, (%[biasptr])\n"
"vse32.v          v25, (a3)\n"
"vse32.v          v26, (a5)\n"
"vse32.v          v27, (a7)\n"
"vse32.v          v28, (t2)\n"
"vse32.v          v29, (t4)\n"
"vse32.v          v30, (a2)\n"
"vse32.v          v31, (a4)\n"
"add %[c_ptr0], %[c_ptr0], 0x10\n"
"add a3, a3, 0x10\n"
"add a5, a5, 0x10\n"
"add a7, a7, 0x10\n"
"add t2, t2, 0x10\n"
"add t4, t4, 0x10\n"
"add a2, a2, 0x10\n"
"add a4, a4, 0x10\n"
"vmv.v.v v25, v24\n"
"vmv.v.v v26, v24\n"
"vmv.v.v v27, v24\n"
"vmv.v.v v28, v24\n"
"vmv.v.v v29, v24\n"
"vmv.v.v v30, v24\n"
"vmv.v.v v31, v24\n"
"vse32.v          v0, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v24, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v24, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v24, f0, v19\n"
"vse32.v          v2, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v25, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v25, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v25, f0, v19\n"
"vse32.v          v4, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v26, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v26, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v26, f0, v19\n"
"vse32.v          v6, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v27, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v27, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v27, f0, v19\n"
"vse32.v          v8, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v28, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v28, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v28, f0, v19\n"
"vse32.v          v10, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v29, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v29, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v29, f0, v19\n"
"vse32.v          v12, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v30, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v30, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v30, f0, v19\n"
"vse32.v          v14, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v31, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v31, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v31, f0, v19\n"
"vse32.v          v1, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v20\n"
"vse32.v          v3, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v20\n"
"vse32.v          v5, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v20\n"
"vse32.v          v7, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v20\n"
"vse32.v          v9, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v20\n"
"vse32.v          v11, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v20\n"
"vse32.v          v13, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v20\n"
"vse32.v          v15, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v20\n"
"add %[biasptr], %[biasptr], %[biasinc]\n"
"j              5f\n"
"2:\n"
"vle32.v          v24, (%[biasptr])\n"
"add %[biasptr], %[biasptr], %[biasinc]\n"
"vmv.v.v v25, v24\n"
"vmv.v.v v26, v24\n"
"vmv.v.v v27, v24\n"
"vmv.v.v v28, v24\n"
"vmv.v.v v29, v24\n"
"vmv.v.v v30, v24\n"
"vmv.v.v v31, v24\n"
"vse32.v          v0, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v24, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v24, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v24, f0, v19\n"
"vse32.v          v2, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v25, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v25, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v25, f0, v19\n"
"vse32.v          v4, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v26, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v26, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v26, f0, v19\n"
"vse32.v          v6, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v27, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v27, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v27, f0, v19\n"
"vse32.v          v8, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v28, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v28, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v28, f0, v19\n"
"vse32.v          v10, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v29, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v29, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v29, f0, v19\n"
"vse32.v          v12, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v30, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v30, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v30, f0, v19\n"
"vse32.v          v14, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v16\n"
"flw            f0, (%[s1])\n"
"vfmacc.vf      v31, f0, v17\n"
"flw            f0, (%[s2])\n"
"vfmacc.vf      v31, f0, v18\n"
"flw            f0, (%[s3])\n"
"vfmacc.vf      v31, f0, v19\n"
"vse32.v          v1, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v24, f0, v20\n"
"vse32.v          v3, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v25, f0, v20\n"
"vse32.v          v5, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v26, f0, v20\n"
"vse32.v          v7, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v27, f0, v20\n"
"vse32.v          v9, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v28, f0, v20\n"
"vse32.v          v11, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v29, f0, v20\n"
"vse32.v          v13, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v30, f0, v20\n"
"vse32.v          v15, (%[s0])\n"
"flw            f0, (%[s0])\n"
"vfmacc.vf      v31, f0, v20\n"
"5:\n"
"flw            f0, (%[minptr])\n"
"vfmv.v.f          v22, f0\n"
"flw            f0, (%[maxptr])\n"
"vfmv.v.f          v23, f0\n"
"vfmax.vv v24, v24, v22\n"
"vfmax.vv v25, v25, v22\n"
"vfmax.vv v26, v26, v22\n"
"vfmax.vv v27, v27, v22\n"
"vfmax.vv v28, v28, v22\n"
"vfmax.vv v29, v29, v22\n"
"vfmax.vv v30, v30, v22\n"
"vfmax.vv v31, v31, v22\n"
"vfmin.vv v24, v24, v23\n"
"vfmin.vv v25, v25, v23\n"
"vfmin.vv v26, v26, v23\n"
"vfmin.vv v27, v27, v23\n"
"vfmin.vv v28, v28, v23\n"
"vfmin.vv v29, v29, v23\n"
"vfmin.vv v30, v30, v23\n"
"vfmin.vv v31, v31, v23\n"
"vse32.v          v24, (%[c_ptr0])\n"
"add %[c_ptr0], %[c_ptr0], 0x10\n"
"vse32.v          v25, (a3)\n"
"vse32.v          v26, (a5)\n"
"vse32.v          v27, (a7)\n"
"vse32.v          v28, (t2)\n"
"vse32.v          v29, (t4)\n"
"vse32.v          v30, (a2)\n"
"vse32.v          v31, (a4)\n"

                    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [s2] "+r" (s2), [s3] "+r" (s3), [g] "+r" (g), [h] "+r" (h)
                    : [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
                    : "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
                      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
                        );
                break;
            case 6:
		__asm__ __volatile__(          
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"

			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add		a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add		a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add		a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add		a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x60\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v8, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v10, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v12, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v14, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v8, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v10, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v12, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v14, (%[a_ptr0])\n"
			"13:\n"
			"add %[a_ptr0], %[a_ptr0], 0x10\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],14f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],15f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],16f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],17f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v9, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],18f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v11, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],19f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v13, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],20f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v15, (a1)\n"
			"j              21f\n"
			"14:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"15:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"16:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"17:\n"
			"vle32.v          v9, (%[a_ptr0])\n"
			"18:\n"
			"vle32.v          v11, (%[a_ptr0])\n"
			"19:\n"
			"vle32.v          v13, (%[a_ptr0])\n"
			"20:\n"
			"vle32.v          v15, (%[a_ptr0])\n"
			"21:\n"

			"beqz		%[loops], 2f\n"
			"vle32.v		v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
				"flw            f0, (%[minptr])\n"
				"vfmv.v.f          v22, f0\n"
				"flw            f0, (%[maxptr])\n"
				"vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v 		v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add		a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add		a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add		a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add		a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x60\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v 		v24, (%[c_ptr0])\n"
			"vle32.v		v24, (%[biasptr])\n"
			"vse32.v 		v25, (a3)\n"
			"vse32.v 		v26, (a5)\n"
			"vse32.v 		v27, (a7)\n"
			"vse32.v 		v28, (t2)\n"
			"vse32.v 		v29, (t4)\n"
			"vse32.v 		v30, (a2)\n"
			"vse32.v 		v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez		%[loops], 4b\n"
			"3:\n"
				"flw            f0, (%[minptr])\n"
				"vfmv.v.f          v22, f0\n"
				"flw            f0, (%[maxptr])\n"
				"vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add            a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add            a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add            a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x60\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j		5f\n"
			"2:\n"
			"vle32.v 		v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"5:\n"
			"flw            f0, (%[minptr])\n"
			"vfmv.v.f          v22, f0\n"
			"flw            f0, (%[maxptr])\n"
			"vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v		v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v		v25, (a3)\n"
			"vse32.v		v26, (a5)\n"
			"vse32.v		v27, (a7)\n"
			"vse32.v		v28, (t2)\n"
			"vse32.v		v29, (t4)\n"
			"vse32.v		v30, (a2)\n"
			"vse32.v		v31, (a4)\n"

		    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [s2] "+r" (s2), [s3] "+r" (s3), [g] "+r" (g), [h] "+r" (h)
			: [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
			: "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
		      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
			);

                break;
            case 7:
		__asm__ __volatile__(          
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"

			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add		a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add		a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add		a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add		a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"add		a1, %[b_ptr0], 0x60\n"
			"vle32.v          v22, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x70\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v8, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v10, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v12, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v14, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v8, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v10, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v12, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v14, (%[a_ptr0])\n"
			"13:\n"
			"add %[a_ptr0], %[a_ptr0], 0x10\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],14f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],15f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],16f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],17f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v9, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],18f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v11, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],19f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v13, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],20f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v15, (a1)\n"
			"j              21f\n"
			"14:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"15:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"16:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"17:\n"
			"vle32.v          v9, (%[a_ptr0])\n"
			"18:\n"
			"vle32.v          v11, (%[a_ptr0])\n"
			"19:\n"
			"vle32.v          v13, (%[a_ptr0])\n"
			"20:\n"
			"vle32.v          v15, (%[a_ptr0])\n"
			"21:\n"

			"beqz		%[loops], 2f\n"
			"vle32.v		v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
				"flw            f0, (%[minptr])\n"
				"vfmv.v.f          v22, f0\n"
				"flw            f0, (%[maxptr])\n"
				"vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v 		v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add		a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add		a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add		a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add		a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"add		a1, %[b_ptr0], 0x60\n"
			"vle32.v          v22, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x70\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v 		v24, (%[c_ptr0])\n"
			"vle32.v		v24, (%[biasptr])\n"
			"vse32.v 		v25, (a3)\n"
			"vse32.v 		v26, (a5)\n"
			"vse32.v 		v27, (a7)\n"
			"vse32.v 		v28, (t2)\n"
			"vse32.v 		v29, (t4)\n"
			"vse32.v 		v30, (a2)\n"
			"vse32.v 		v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez		%[loops], 4b\n"
			"3:\n"
				"flw            f0, (%[minptr])\n"
				"vfmv.v.f          v22, f0\n"
				"flw            f0, (%[maxptr])\n"
				"vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add            a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add            a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add            a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"add            a1, %[b_ptr0], 0x60\n"
			"vle32.v          v22, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x70\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j		5f\n"
			"2:\n"
			"vle32.v 		v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"5:\n"
			"flw            f0, (%[minptr])\n"
			"vfmv.v.f          v22, f0\n"
			"flw            f0, (%[maxptr])\n"
			"vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v		v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v		v25, (a3)\n"
			"vse32.v		v26, (a5)\n"
			"vse32.v		v27, (a7)\n"
			"vse32.v		v28, (t2)\n"
			"vse32.v		v29, (t4)\n"
			"vse32.v		v30, (a2)\n"
			"vse32.v		v31, (a4)\n"

		    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [s2] "+r" (s2), [s3] "+r" (s3), [g] "+r" (g), [h] "+r" (h)
			: [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
			: "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
		      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
			);
                break;
            default:
            case 8:
		__asm__ __volatile__(          
			"li  a0, 4\n"
			"vsetvli  t0, a0, e32, m1\n"
			
			"add a3, %[c_ptr0], %[ldc]\n"
			"add a5, a3, %[ldc]\n"
			"add a7, a5, %[ldc]\n"
			"add t2, a7, %[ldc]\n"
			"add t4, t2, %[ldc]\n"
			"add a2, t4, %[ldc]\n"
			"add a4, a2, %[ldc]\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t4, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add t2, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a7, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b10000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a5, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b100000\n"
			"beqz           %[oob_rows], 1f\n"
			"addi %[oob_rows], %[oob_rows], -0x1\n"
			"add a3, %[c_ptr0], 0x0\n"
			"add %[g], %[g], 0b1000000\n"

			"1:\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add		a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add		a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add		a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add		a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"add		a1, %[b_ptr0], 0x60\n"
			"vle32.v          v22, (a1)\n"
			"add		a1, %[b_ptr0], 0x70\n"
			"vle32.v          v23, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x80\n"

			"vle32.v          v0, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],6f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v2, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],7f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v4, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],8f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v6, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],9f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v8, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],10f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v10, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],11f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v12, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],12f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v14, (a1)\n"
			"j              13f\n"
			"6:\n"
			"vle32.v          v2, (%[a_ptr0])\n"
			"7:\n"
			"vle32.v          v4, (%[a_ptr0])\n"
			"8:\n"
			"vle32.v          v6, (%[a_ptr0])\n"
			"9:\n"
			"vle32.v          v8, (%[a_ptr0])\n"
			"10:\n"
			"vle32.v          v10, (%[a_ptr0])\n"
			"11:\n"
			"vle32.v          v12, (%[a_ptr0])\n"
			"12:\n"
			"vle32.v          v14, (%[a_ptr0])\n"
			"13:\n"
			"add %[a_ptr0], %[a_ptr0], 0x10\n"
			"vle32.v          v1, (%[a_ptr0])\n"
			"andi           %[h], %[g], 0b1000000\n"
			"bnez           %[h],14f\n"
			"add a1, %[a_ptr0], %[lda]\n"
			"vle32.v          v3, (a1)\n"
			"andi           %[h], %[g], 0b100000\n"
			"bnez           %[h],15f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v5, (a1)\n"
			"andi           %[h], %[g], 0b10000\n"
			"bnez           %[h],16f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v7, (a1)\n"
			"andi           %[h], %[g], 0b1000\n"
			"bnez           %[h],17f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v9, (a1)\n"
			"andi           %[h], %[g], 0b100\n"
			"bnez           %[h],18f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v11, (a1)\n"
			"andi           %[h], %[g], 0b10\n"
			"bnez           %[h],19f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v13, (a1)\n"
			"andi           %[h], %[g], 0b1\n"
			"bnez           %[h],20f\n"
			"add a1, a1, %[lda]\n"
			"vle32.v          v15, (a1)\n"
			"j              21f\n"
			"14:\n"
			"vle32.v          v3, (%[a_ptr0])\n"
			"15:\n"
			"vle32.v          v5, (%[a_ptr0])\n"
			"16:\n"
			"vle32.v          v7, (%[a_ptr0])\n"
			"17:\n"
			"vle32.v          v9, (%[a_ptr0])\n"
			"18:\n"
			"vle32.v          v11, (%[a_ptr0])\n"
			"19:\n"
			"vle32.v          v13, (%[a_ptr0])\n"
			"20:\n"
			"vle32.v          v15, (%[a_ptr0])\n"
			"21:\n"

			"beqz		%[loops], 2f\n"
			"vle32.v		v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"addi %[loops], %[loops], -0x1\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v23\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v23\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v23\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v23\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v23\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v23\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v23\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v23\n"
			"beqz           %[loops], 3f\n"
			"4:\n"
				"flw            f0, (%[minptr])\n"
				"vfmv.v.f          v22, f0\n"
				"flw            f0, (%[maxptr])\n"
				"vfmv.v.f          v23, f0\n"
			"addi %[loops], %[loops], -0x1\n"
			"vle32.v 		v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add		a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add		a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add		a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add		a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"add		a1, %[b_ptr0], 0x60\n"
			"vle32.v          v22, (a1)\n"
			"add		a1, %[b_ptr0], 0x70\n"
			"vle32.v          v23, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x80\n"
			"vse32.v 		v24, (%[c_ptr0])\n"
			"vle32.v		v24, (%[biasptr])\n"
			"vse32.v 		v25, (a3)\n"
			"vse32.v 		v26, (a5)\n"
			"vse32.v 		v27, (a7)\n"
			"vse32.v 		v28, (t2)\n"
			"vse32.v 		v29, (t4)\n"
			"vse32.v 		v30, (a2)\n"
			"vse32.v 		v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v23\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v23\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v23\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v23\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v23\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v23\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v23\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v23\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"bnez		%[loops], 4b\n"
			"3:\n"
				"flw            f0, (%[minptr])\n"
				"vfmv.v.f          v22, f0\n"
				"flw            f0, (%[maxptr])\n"
				"vfmv.v.f          v23, f0\n"
			"vle32.v          v16, (%[b_ptr0])\n"
			"add		a1, %[b_ptr0], 0x10\n"
			"vle32.v          v17, (a1)\n"
			"add            a1, %[b_ptr0], 0x20\n"
			"vle32.v          v18, (a1)\n"
			"add            a1, %[b_ptr0], 0x30\n"
			"vle32.v          v19, (a1)\n"
			"add            a1, %[b_ptr0], 0x40\n"
			"vle32.v          v20, (a1)\n"
			"add            a1, %[b_ptr0], 0x50\n"
			"vle32.v          v21, (a1)\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"add            a1, %[b_ptr0], 0x60\n"
			"vle32.v          v22, (a1)\n"
			"add            a1, %[b_ptr0], 0x70\n"
			"vle32.v          v23, (a1)\n"
			"add %[b_ptr0], %[b_ptr0], 0x80\n"
			"vse32.v          v24, (%[c_ptr0])\n"
			"vle32.v          v24, (%[biasptr])\n"
			"vse32.v          v25, (a3)\n"
			"vse32.v          v26, (a5)\n"
			"vse32.v          v27, (a7)\n"
			"vse32.v          v28, (t2)\n"
			"vse32.v          v29, (t4)\n"
			"vse32.v          v30, (a2)\n"
			"vse32.v          v31, (a4)\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"add a3, a3, 0x10\n"
			"add a5, a5, 0x10\n"
			"add a7, a7, 0x10\n"
			"add t2, t2, 0x10\n"
			"add t4, t4, 0x10\n"
			"add a2, a2, 0x10\n"
			"add a4, a4, 0x10\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v23\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v23\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v23\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v23\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v23\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v23\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v23\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v23\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"j		5f\n"
			"2:\n"
			"vle32.v 		v24, (%[biasptr])\n"
			"add %[biasptr], %[biasptr], %[biasinc]\n"
			"vmv.v.v v25, v24\n"
			"vmv.v.v v26, v24\n"
			"vmv.v.v v27, v24\n"
			"vmv.v.v v28, v24\n"
			"vmv.v.v v29, v24\n"
			"vmv.v.v v30, v24\n"
			"vmv.v.v v31, v24\n"
			"vse32.v          v0, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v19\n"
			"vse32.v          v2, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v19\n"
			"vse32.v          v4, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v19\n"
			"vse32.v          v6, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v19\n"
			"vse32.v          v8, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v19\n"
			"vse32.v          v10, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v19\n"
			"vse32.v          v12, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v19\n"
			"vse32.v          v14, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v16\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v17\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v18\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v19\n"
			
			"vse32.v          v1, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v24, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v24, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v24, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v24, f0, v23\n"
			"vse32.v          v3, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v25, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v25, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v25, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v25, f0, v23\n"
			"vse32.v          v5, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v26, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v26, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v26, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v26, f0, v23\n"
			"vse32.v          v7, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v27, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v27, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v27, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v27, f0, v23\n"
			"vse32.v          v9, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v28, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v28, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v28, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v28, f0, v23\n"
			"vse32.v          v11, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v29, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v29, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v29, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v29, f0, v23\n"
			"vse32.v          v13, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v30, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v30, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v30, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v30, f0, v23\n"
			"vse32.v          v15, (%[s0])\n"
			"flw            f0, (%[s0])\n"
			"vfmacc.vf      v31, f0, v20\n"
			"flw            f0, (%[s1])\n"
			"vfmacc.vf      v31, f0, v21\n"
			"flw            f0, (%[s2])\n"
			"vfmacc.vf      v31, f0, v22\n"
			"flw            f0, (%[s3])\n"
			"vfmacc.vf      v31, f0, v23\n"
			"5:\n"
			"flw            f0, (%[minptr])\n"
			"vfmv.v.f          v22, f0\n"
			"flw            f0, (%[maxptr])\n"
			"vfmv.v.f          v23, f0\n"
			"vfmax.vv v24, v24, v22\n"
			"vfmax.vv v25, v25, v22\n"
			"vfmax.vv v26, v26, v22\n"
			"vfmax.vv v27, v27, v22\n"
			"vfmax.vv v28, v28, v22\n"
			"vfmax.vv v29, v29, v22\n"
			"vfmax.vv v30, v30, v22\n"
			"vfmax.vv v31, v31, v22\n"
			"vfmin.vv v24, v24, v23\n"
			"vfmin.vv v25, v25, v23\n"
			"vfmin.vv v26, v26, v23\n"
			"vfmin.vv v27, v27, v23\n"
			"vfmin.vv v28, v28, v23\n"
			"vfmin.vv v29, v29, v23\n"
			"vfmin.vv v30, v30, v23\n"
			"vfmin.vv v31, v31, v23\n"
			"vse32.v		v24, (%[c_ptr0])\n"
			"add %[c_ptr0], %[c_ptr0], 0x10\n"
			"vse32.v		v25, (a3)\n"
			"vse32.v		v26, (a5)\n"
			"vse32.v		v27, (a7)\n"
			"vse32.v		v28, (t2)\n"
			"vse32.v		v29, (t4)\n"
			"vse32.v		v30, (a2)\n"
			"vse32.v		v31, (a4)\n"

		    : [a_ptr0] "+r" (a_ptr0), [b_ptr0] "+r" (b_ptr0), [c_ptr0] "+r" (c_ptr0), [loops] "+r" (loops), [oob_rows] "+r" (oob_rows), [biasptr] "+r" (biasptr), [s0] "+r" (s0), [s1] "+r" (s1), [s2] "+r" (s2), [s3] "+r" (s3), [g] "+r" (g), [h] "+r" (h)
            : [lda] "r" (ldab), [ldc] "r" (ldcb), [biasinc] "r" (biasinc), [minptr] "r" (minptr), [maxptr] "r" (maxptr)
                    : "v0", "v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10", "v11", "v12", "v13", "v14", "v15", "v16", "v17", "v18", "v19", "v20", "v21", "v22", "v23", "v24", "v25", "v26", "v27", "v28", "v29", "v30", "v31",
		      "t0", "t2", "t4", "a2", "a4", "a0", "a1", "a3", "a5", "a7", "f0"
                        );
                break;
        }
    }
}

} // namespace arm_gemm

#endif // __aarch64__
